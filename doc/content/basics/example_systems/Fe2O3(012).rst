.. _example_Fe2O3:

Hematite (012)-(1×1)
====================

Hematite (:math:`\alpha \text{-Fe}_2\text{O}_3`) is the one of them most common
naturally occurring iron oxides. Its surfaces are popular model
systems for (single-atom) catalysis
:cite:p:`kraushoferAtomicscaleStructureHematite2018,franceschiModelSystemPhotocatalysis2020`,
photocatalysis and the study of mineral-water interfaces.

The :math:`(1\bar{1}02)` surface (also referred to as :math:`(012)`, or r-cut)
exhibits two stable terminations under :term:`UHV` conditions: a stoichiometric
(1×1) bulk-truncated termination, and a reduced (2×1) reconstruction
:cite:p:`kraushoferAtomicscaleStructureHematite2018`.
Here we use the bulk-truncated (1×1) surface as an example system of a "medium
complexity" oxide surface and will compare experimental LEED :math:`I(V)` data
[#]_ with a theory calculation in ViPErLEED.

All input files needed to follow along on your own machine can be found
:download:`here</_static/example_systems/Fe2O3-(1x1)/input_files.zip>`.

.. tip:: 
   If you are new to ViPErLEED, check out :ref:`this tutorial<example_ag_100>`
   first, which explains how to set up a calculation in more detail.

Introduction
============

To set up the calculation, we need to start from a structure model of the (1×1)
surface in the POSCAR format. We can easily build this ourselves from a
(:math:`\alpha \text{-Fe}_2\text{O}_3`) bulk structure.
For this example, we use the structure by
:cite:t:`maslenSynchrotronXrayStudy1994`, which can be found on the
`Crystallography Open Database (entry 2101167) <http://www.crystallography.net/cod/2101167.html>`_.

.. warning:: 
    Bulk structures can be found in various online databases, but you should be
    careful to choose a model with the correct **experimental** lattice
    parameters (as determined by :term:`XRD`).
    Lattice parameters from e.g. :term:`DFT` calculations may be off by ~1%,
    which will strongly affect the R-factor.
    Lattice parameters are not accessible in the
    :ref:`tensor LEED approximation<tensor_leed>`, but they can be optimized in
    a :ref:`full-dynamic optimization<fdoptimization>`.

To go from the rhombohedral bulk unit cell to the unit cell for the
:math:`(1\bar{1}02)` (r-cut) surface, we need to apply a suitable change of
basis:

.. math::
    (a', b', c') = (a,b,c) P

    P  = \frac{1}{3} \begin{pmatrix}
                        3 & 1  & 2 \\
                        0 & 2  & 4 \\
                        0 & -1 & 1
                     \end{pmatrix}

In VESTA, you can do this by selecting "Edit" -> "Edit Data" -> "Unit cell" ->
"Transform".

To create a suitable surface slab (as expected by ViPErLEED), we can then
replicate the unit cell along :math:`\vec{c}` and (optionally) remove the
topmost layer to create a vacuum interface.
In VESTA you can do this similarly, by applying a transformation which stretches
the cell in the :math:`\vec{c}` direction.
When doing this, VESTA may prompt you and ask what to do with the atoms in the
new unit cell.
Make sure to choose "Search atoms in the new unit-cell and add them as new
sites".

The our starting POSCAR file contains 40 atoms in total, which corresponds to
4 repeat units (layers) of 4 Fe and 6 O atoms each.


PARAMETERS and VIBROCC
======================

As in pervious examples, we begin with a simple
:ref:`PARAMETERS file<parameters>`:

.. literalinclude :: /_static/example_systems/Fe(012)-(1x1)/PARAMETERS
   :language: console
   :caption: PARAMETERS

The settings concerning global parameters and the :ref:`VIBROCC file<viboccin>`
have been discussed in detail elsewhere (see e.g. :ref:`here<example_ag_100>`).
Note, however, the parameters concerning the structure interpretation.
To let ViPErLEED know what we consider the bulk structure, we generally need to
define the parameters :ref:`BULK_REPEAT`, :ref:`LAYER_CUTS`
and :ref:`N_BULK_LAYERS`.
Alternatively, as is done here, we could also specify the parameter
:ref:`BULK_LIKE_BELOW` with a suitable value (0.35 for the given POSCAR file).

We also use the :ref:`SITE_DEF<sitedef>` parameter to define which sites should
be treated separately by ViPErLEED.
In this case, we declare two ``surface`` sites each for iron and oxygen. This
will assign the two topmost atoms of each species to the surface, and treat them
as different sites in the calculation.
They will thus be assigned different electron-atom scattering phaseshifts (see
file :ref:`PHASESHIFTS`) and different vibrational amplitudes.


Initial vibrational amplitudes can be calculated based on the sample's Debye
temperature with the parameters :ref:`T_DEBYE`, :ref:`T_EXPERIMENT` and
:ref:`VIB_AMP_SCALE`. Instead, you can also provide the amplitudes directly in
the :ref:`VIBROCC file<viboccin>`: 

.. literalinclude :: /_static/example_systems/Fe(012)-(1x1)/VIBROCC
   :language: console
   :caption: VIBROCC


Initialization
==============

We can now run the initialization to check if all input files are interpreted
correctly. If so, the :ref:`log<log_files_tleedm>` should look similar to this:

.. literalinclude :: /_static/example_systems/Fe(012)-(1x1)/log_init.txt
   :language: console
   :caption: Initialization log

The initialization log shows that the input files are interpreted correctly and
that the ``pg[0 1]`` plane group is detected.
It also shows that the bulk structure and repeat vector have been identified.
This is reflected in the PARAMETERS file, which was updated in-place and should
now contain the following lines:

.. literalinclude :: /_static/example_systems/Fe(012)-(1x1)/PARAMETERS_bulk_detected
   :language: console
   :caption: PARAMETERS after initialization

At this stage, before proceeding, you should always double-check the detected
bulk structure and spacing, as it is crucial for the calculation.
To help with this, ViPErLEED provides the files
:ref:`POSCAR_bulk and POSCAR_bulk_appended<poscar_bulk>`.
The former contains the crystal bulk structure as detected by ViPErLEED, and the
latter contains the surface slab with additional bulk layers appended to it.
You can visualize these files in VESTA to check if the bulk structure is as you
expect.
In particular, one should make sure that the bulk stoichiometry for POSCAR_bulk,
and the bulk layer spacing for POSCAR_bulk_appended, are as correct.

Reference Calculation and Structure Optimization
================================================

If the initialization ran without errors, we can proceed to the reference
calculation and structure optimization. You can find more details about what
happens in each section of a ViPErLEED LEED-I(V) calculation :ref:`here<tleedm>`.

In short, the reference calculation performs a full-dynamic LEED calculation to
generate I(V) curves for the input structure.


In the structure optimization, we 

We can now set up a :ref:`DISPLACEMENTS file<displacements>`:

Full-dynamic Optimization
=========================


.. [#] The data was obtained by Alexander M. Imre and Michele Riva, with further
support provided by Florian Kraushofer, Giada Franceschi, Tilman Kißlinger and
Lutz Hammer.

**TODO** refer to the ViPErLEED paper
