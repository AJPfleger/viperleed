.. _example_Cu-Te:

==========================================
Example System: Copper Telluride ad-chains
==========================================

The following example covers a ViPErLEED analysis and structure optimization for a copper telluride layer on Cu(111) based on the paper by :cite:t:`kisslingerSubmonolayerCopperTelluride2021`.
The experimental data and the outline for the analysis steps described below were provided by the publications' authors.
This system deals with :math:`(5\times \sqrt{3})_{\text{rect}}` superstructure and has 10 atoms per bulk layer.
It serves as an example for how a more challenging system can be treated with ViPErLEEDs.
In fact, the analysis presented in the original publication was performed using an early development version of ViPErLEED :cite:p:`kisslingerSubmonolayerCopperTelluride2021`.

All input files needed to follow along on your own machine can be found here. **TODO add download link**

.. tip:: 
   If you are new to ViPErLEED, check out :ref:`this tutorial<example_ag_100>` first, which explains the basics in more detail.

Introduction
============

The system we are analyzing is a :math:`(5\times \sqrt{3})_{\text{rect}}` superstructure of copper telluride on the hexagonal Cu(111) substrate.
The Tellurium coverage is 0.40 mono-layers, which equates to 4 Tellurium atoms per surface unit cell.

For our example analysis we start from a qualitatively correct structure model (:ref:`POSCAR file<poscar>`) with correct layer stacking :cite:p:`kisslingerSubmonolayerCopperTelluride2021`.
However, the initial atom positions in the POSCAR are taken from bulk Cu, so we need to expect significant relaxation during the structure-optimization.
We will need to run multiple delta
The individual :ref:`DISPLACEMENTS files<displacements>` are not all shown in full below, but you can download all input files here. **TODO**

**TODO Lutz:** It would be nice if we could put one to three LEED patterns and figures of the structure (like for Ir(100)-O) here. I can't take them directly from the paper for legal reasons – but since you are the author, you could send me the original ones ;)

On the experimental side, we have a set of 79 beams in our energy range (20 to 500eV) – stored in the file :ref:`EXPBEAMS.csv<expbeams>`.
These beams correspond to a total energy range of around 17500 eV, of which only around 1800 eV are from integer beams.

Setup
=====

PARAMETERS
----------

Similar to the previous examples, we start by setting up a :ref:`PARAMETERS file<parameters>` file:

.. literalinclude :: /_static/example_systems/Cu-Te/PARAMETERS
   :language: console
   :caption: PARAMETERS

Most of the used parameters have been explained in :ref:`previous examples<example_ag_100>`, so will skip some details here.
Worth mentioning in this particular case is that we use :ref:`SITE_DEF<sitedef>` to define the two topmost Copper and Tellurium atoms as explicit surface sites.
We are further using the :ref:`SUPERLATTICE parameter<superlattice>` to manually define the surface superlattice type and orientation (to match the convention used in :ref:`EXPBEAMS.csv<expbeams>`).

As usual, :ref:`IVBEAMS<ivbeams>` and :ref:`PHASESHIFTS<phaseshifts>` are generated automatically during initialization (:ref:`RUN = 0<run>`).
The :ref:`VIBROCC file<viboccin>` will also be generated by ViPErLEED based on the provided parameters :ref:`T_DEBYE<t_debye>`, :ref:`T_EXPERIMENT<t_experiment>`, and :ref:`VIBR_AMP_SCALE<VIBR_AMP_SCALE>`.

DISPLACEMENTS
-------------

For the delta-amplitudes calculation and the structure optimization, we will start out with a very rough grid of geometric optimizations.
We start with optimizations normal to the surface(:math:`z`) and follow that up by in-plane optimization.

.. literalinclude :: /_static/example_systems/Cu-Te/DISPLACEMENTS_1
   :language: console
   :caption: DISPLACEMENTS_1

.. note::
    Note that we allow displacements of up to 300 pm for Tellurium to speed up the convergence in this example.
    Normally, this is not recommended.
    It **will** lead to significant errors, because 300 pm is well outside the range where the tensor LEED approximation is applicable.



Full-dynamic optimization
=========================

Refined structure fit
=====================

Error calculation
=================

