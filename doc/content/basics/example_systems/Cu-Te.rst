.. _example_Cu-Te:

==========================================
Example System: Copper Telluride ad-chains
==========================================

The following example covers a ViPErLEED analysis and structure optimization for a copper telluride layer on Cu(111) based on the paper by :cite:t:`kisslingerSubmonolayerCopperTelluride2021`.
The experimental data and the outline for the analysis steps described below were provided by the publications' authors.
This system deals with :math:`(5\times \sqrt{3})_{\text{rect}}` superstructure and has 10 atoms per bulk layer.
It serves as an example for how a more challenging system can be treated with ViPErLEEDs.
In fact, the analysis presented in the original publication was performed using an early development version of ViPErLEED :cite:p:`kisslingerSubmonolayerCopperTelluride2021`.

All input files needed to follow along on your own machine can be found here. **TODO add download link**

.. tip:: 
   If you are new to ViPErLEED, check out :ref:`this tutorial<example_ag_100>` first, which explains the basics in more detail.

Introduction
============

The system we are analyzing is a :math:`(5\times \sqrt{3})_{\text{rect}}` superstructure of copper telluride on the hexagonal Cu(111) substrate.
The Tellurium coverage is 0.40 mono-layers, which equates to 4 Tellurium atoms per surface unit cell.

For our example analysis we start from a qualitatively correct structure model (:ref:`POSCAR file<poscar>`) with correct layer stacking :cite:p:`kisslingerSubmonolayerCopperTelluride2021`.
However, the initial atom positions in the POSCAR are taken from bulk Cu, so we need to expect significant relaxation during the structure-optimization.
We will need to run multiple delta
The individual :ref:`DISPLACEMENTS files<displacements>` are not all shown in full below, but you can download all input files here. **TODO**

**TODO Lutz:** It would be nice if we could put one to three LEED patterns and figures of the structure (like for Ir(100)-O) here. I can't take them directly from the paper for legal reasons – but since you are the author, you could send me the original ones ;)

On the experimental side, we have a set of 79 beams in our energy range (20 to 500eV) – stored in the file :ref:`EXPBEAMS.csv<expbeams>`.
These beams correspond to a total energy range of around 17500 eV, of which only around 1800 eV are from integer beams.

Setup
=====

PARAMETERS
----------

Similar to the previous examples, we start by setting up a :ref:`PARAMETERS file<parameters>` file:

.. literalinclude :: /_static/example_systems/Cu-Te/PARAMETERS
   :language: console
   :caption: PARAMETERS

Most of the used parameters have been explained in :ref:`previous examples<example_ag_100>`, so will skip some details here.
Worth mentioning in this particular case is that we use :ref:`SITE_DEF<sitedef>` to define the two topmost Copper and Tellurium atoms as explicit surface sites.
We are further using the :ref:`SUPERLATTICE parameter<superlattice>` to manually define the surface superlattice type and orientation (to match the convention used in :ref:`EXPBEAMS.csv<expbeams>`).

As usual, :ref:`IVBEAMS<ivbeams>` and :ref:`PHASESHIFTS<phaseshifts>` are generated automatically during initialization (:ref:`RUN = 0<run>`).
The :ref:`VIBROCC file<viboccin>` will also be generated by ViPErLEED based on the provided parameters :ref:`T_DEBYE<t_debye>`, :ref:`T_EXPERIMENT<t_experiment>`, and :ref:`VIBR_AMP_SCALE<VIBR_AMP_SCALE>`.

DISPLACEMENTS
-------------

For the delta-amplitudes calculation and the structure optimization, we will start out with a very rough grid of geometric optimizations.
We start with optimizations normal to the surface(:math:`z`) and follow that up by in-plane optimization.

.. literalinclude :: /_static/example_systems/Cu-Te/DISPLACEMENTS_1
   :language: console
   :caption: DISPLACEMENTS_1

.. note::
    Note that we allow displacements of up to 300 pm for Tellurium to speed up the convergence in this example.
    Normally, this is not recommended.
    It **will** lead to significant errors, because 300 pm is well outside the range where the tensor LEED approximation is applicable.



Full-dynamic optimization
=========================

After this initial structure optimization, we want to optimize the parameter :math:`V_{0\text{i}}` the imaginary part of the solid inner potential.
This parameter strongly affects the R-factor, but is hard to gauge for an unknown system.
Since we didn't specify a value for :math:`V_{0\text{i}}` in PARAMETERS, ViPErLEED took the default value of 4.5 eV (see :ref:`parameter V0_IMAG<v0_imag>`).
:math:`V_{0\text{i}}` is not accessible in the tensor LEED approximation, but we can use a :ref:`full-dynamic optimization<fdoptimization>` to find an optimal value.
To do this, we set :ref:`RUN = 6<run>` and add this line to :ref:`PARAMETERS<parameters>`:

.. code-block:: console

    OPTIMIZE V0i = step 0.5

The optimized value for :math:`V_{0\text{i}}` will be output in the log file and automatically added to the :ref:`PARAMETERS file<parameters>` for subsequent runs.
Furthermore, ViPErLEED produces the files :ref:`FD_Optimization_beams.pdf<fdoptimizationbeams>` and :ref:`FD_Optimization.pdf<fdoptimizationdata>` in the ``OUT`` directory.
:ref:`FD_Optimization_beams.pdf<fdoptimizationbeams>` shows the calculated diffraction intensities for different values of the optimized parameter, while :ref:`FD_Optimization.pdf<fdoptimizationdata>` shows the R-factors corresponding to each trial value.

.. figure:: /_static/example_systems/Cu(111)-Te/figures/FD_beams.pdf
   :width: 100%
   :align: center

   Part of ``FD_Optimization_beams.pdf`` showing the effects of :math:`V_{0\text{i}}` on the :math:`(0|1)` beam.

Refined structure fit
=====================

As usual, we can now perform some more refined structure optimization on less coarse grids.
In particular, we should also optimize the vibrational amplitudes, which we have skipped so far.

Error calculation
=================

